I tensorflow/stream_executor/dso_loader.cc:108] successfully opened CUDA library libcublas.so locally
I tensorflow/stream_executor/dso_loader.cc:108] successfully opened CUDA library libcudnn.so locally
I tensorflow/stream_executor/dso_loader.cc:108] successfully opened CUDA library libcufft.so locally
I tensorflow/stream_executor/dso_loader.cc:108] successfully opened CUDA library libcuda.so.1 locally
I tensorflow/stream_executor/dso_loader.cc:108] successfully opened CUDA library libcurand.so locally
INFO:root:Get NLC data in /gss_gpfs_scratch/dong.r/Dataset/BCI/Sublex/1/1/train/sub
INFO:root:Vocabulary size: 30
I tensorflow/core/common_runtime/gpu/gpu_init.cc:102] Found device 0 with properties: 
name: Tesla K20m
major: 3 minor: 5 memoryClockRate (GHz) 0.7055
pciBusID 0000:04:00.0
Total memory: 4.63GiB
Free memory: 4.56GiB
I tensorflow/core/common_runtime/gpu/gpu_init.cc:126] DMA: 0 
I tensorflow/core/common_runtime/gpu/gpu_init.cc:136] 0:   Y 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:838] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla K20m, pci bus id: 0000:04:00.0)
INFO:root:Creating 3 layers of 512 units.
INFO:root:Created model with fresh parameters.
INFO:root:Num params: 27574814
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:244] PoolAllocator: After 3229 get requests, put_count=2244 evicted_count=1000 eviction_rate=0.445633 and unsatisfied allocation rate=0.645711
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:256] Raising pool_size_limit_ from 100 to 110
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:244] PoolAllocator: After 1283 get requests, put_count=3299 evicted_count=2000 eviction_rate=0.606244 and unsatisfied allocation rate=0
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:244] PoolAllocator: After 4413 get requests, put_count=7563 evicted_count=4000 eviction_rate=0.528891 and unsatisfied allocation rate=0.198958
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:256] Raising pool_size_limit_ from 309 to 339
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:244] PoolAllocator: After 5498 get requests, put_count=4525 evicted_count=2000 eviction_rate=0.441989 and unsatisfied allocation rate=0.548745
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:256] Raising pool_size_limit_ from 493 to 542
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:244] PoolAllocator: After 1454 get requests, put_count=2541 evicted_count=1000 eviction_rate=0.393546 and unsatisfied allocation rate=0
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:244] PoolAllocator: After 4954 get requests, put_count=5842 evicted_count=2000 eviction_rate=0.342349 and unsatisfied allocation rate=0.250101
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:256] Raising pool_size_limit_ from 1400 to 1540
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:244] PoolAllocator: After 28805 get requests, put_count=32104 evicted_count=9000 eviction_rate=0.280339 and unsatisfied allocation rate=0.203263
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:256] Raising pool_size_limit_ from 1694 to 1863
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:244] PoolAllocator: After 1682 get requests, put_count=2929 evicted_count=1000 eviction_rate=0.341413 and unsatisfied allocation rate=0
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:244] PoolAllocator: After 170576 get requests, put_count=170769 evicted_count=1000 eviction_rate=0.00585586 and unsatisfied allocation rate=0.00685325
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:256] Raising pool_size_limit_ from 3987 to 4385
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:244] PoolAllocator: After 54731 get requests, put_count=57131 evicted_count=5000 eviction_rate=0.0875182 and unsatisfied allocation rate=0.0563118
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:256] Raising pool_size_limit_ from 5305 to 5835
INFO:root:epoch 1, iter 200, cost 2.828766, exp_cost 2.981325, grad norm 5.570015, param norm 103.648834, tps 1416.397226, length mean/std 17.000000/0.000000
INFO:root:epoch 1, iter 400, cost 2.787362, exp_cost 2.837667, grad norm 9.253434, param norm 113.854431, tps 1461.470655, length mean/std 34.000000/0.000000
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:244] PoolAllocator: After 1630 get requests, put_count=3484 evicted_count=1000 eviction_rate=0.287026 and unsatisfied allocation rate=0
INFO:root:epoch 1, iter 600, cost 2.787901, exp_cost 2.799396, grad norm 17.696142, param norm 121.562775, tps 1479.819476, length mean/std 96.000000/0.000000
INFO:root:epoch 1, iter 800, cost 2.693811, exp_cost 2.777867, grad norm 7.659207, param norm 127.932304, tps 1488.234715, length mean/std 25.000000/0.000000
INFO:root:epoch 1, iter 1000, cost 2.779958, exp_cost 2.762957, grad norm 7.168238, param norm 133.216599, tps 1492.388606, length mean/std 23.000000/0.000000
INFO:root:epoch 1, iter 1200, cost 2.798546, exp_cost 2.758053, grad norm 8.284928, param norm 137.471695, tps 1497.077723, length mean/std 33.000000/0.000000
INFO:root:epoch 1, iter 1400, cost 2.708029, exp_cost 2.746147, grad norm 13.612422, param norm 141.706589, tps 1499.481640, length mean/std 66.000000/0.000000
INFO:root:epoch 1, iter 1600, cost 2.763655, exp_cost 2.739306, grad norm 18.394123, param norm 145.547089, tps 1501.076800, length mean/std 71.000000/0.000000
INFO:root:epoch 1, iter 1800, cost 2.722250, exp_cost 2.730072, grad norm 8.757298, param norm 148.847748, tps 1503.371138, length mean/std 27.000000/0.000000
INFO:root:epoch 1, iter 2000, cost 2.728315, exp_cost 2.726811, grad norm 22.563286, param norm 152.059784, tps 1502.895303, length mean/std 116.000000/0.000000
INFO:root:epoch 1, iter 2200, cost 2.705448, exp_cost 2.719159, grad norm 12.968515, param norm 155.112946, tps 1502.899270, length mean/std 67.000000/0.000000
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:244] PoolAllocator: After 4133783 get requests, put_count=4134166 evicted_count=2000 eviction_rate=0.000483774 and unsatisfied allocation rate=0.000665976
INFO:root:epoch 1, iter 2400, cost 2.813512, exp_cost 2.716476, grad norm 6.033398, param norm 157.931610, tps 1504.525149, length mean/std 13.000000/0.000000
INFO:root:epoch 1, iter 2600, cost 2.657641, exp_cost 2.711949, grad norm 11.819945, param norm 160.612701, tps 1505.136947, length mean/std 47.000000/0.000000
INFO:root:epoch 1, iter 2800, cost 2.629005, exp_cost 2.715319, grad norm 10.037038, param norm 163.150665, tps 1504.672453, length mean/std 33.000000/0.000000
INFO:root:epoch 1, iter 3000, cost 2.824736, exp_cost 2.708191, grad norm 5.429732, param norm 165.658295, tps 1503.885387, length mean/std 9.000000/0.000000
INFO:root:epoch 1, iter 3200, cost 2.711534, exp_cost 2.709446, grad norm 15.896107, param norm 168.038666, tps 1504.733724, length mean/std 73.000000/0.000000
INFO:root:epoch 1, iter 3400, cost 2.650296, exp_cost 2.700122, grad norm 12.514333, param norm 170.226181, tps 1506.302442, length mean/std 47.000000/0.000000
INFO:root:epoch 1, iter 3600, cost 2.666979, exp_cost 2.701124, grad norm 6.606286, param norm 172.340347, tps 1507.333128, length mean/std 13.000000/0.000000
INFO:root:epoch 1, iter 3800, cost 2.685253, exp_cost 2.697644, grad norm 18.832977, param norm 174.466660, tps 1507.316842, length mean/std 93.000000/0.000000
INFO:root:epoch 1, iter 4000, cost 2.704885, exp_cost 2.697505, grad norm 7.883584, param norm 176.756729, tps 1508.681660, length mean/std 20.000000/0.000000
INFO:root:epoch 1, iter 4200, cost 2.705981, exp_cost 2.688411, grad norm 8.021830, param norm 178.833984, tps 1508.879010, length mean/std 19.000000/0.000000
INFO:root:epoch 1, iter 4400, cost 2.699591, exp_cost 2.692105, grad norm 8.369198, param norm 180.988220, tps 1510.494611, length mean/std 22.000000/0.000000
INFO:root:epoch 1, iter 4600, cost 2.711607, exp_cost 2.690601, grad norm 20.739260, param norm 182.649094, tps 1510.555089, length mean/std 113.000000/0.000000
INFO:root:epoch 1, iter 4800, cost 2.712588, exp_cost 2.687597, grad norm 9.844481, param norm 184.480591, tps 1511.897504, length mean/std 31.000000/0.000000
INFO:root:epoch 1, iter 5000, cost 2.648906, exp_cost 2.678360, grad norm 12.293941, param norm 186.538071, tps 1512.466191, length mean/std 43.000000/0.000000
INFO:root:epoch 1, iter 5200, cost 2.576785, exp_cost 2.682659, grad norm 6.316267, param norm 188.429596, tps 1512.937009, length mean/std 11.000000/0.000000
INFO:root:epoch 1, iter 5400, cost 2.660916, exp_cost 2.683007, grad norm 9.831746, param norm 189.942978, tps 1512.076742, length mean/std 29.000000/0.000000
INFO:root:epoch 1, iter 5600, cost 2.643489, exp_cost 2.679509, grad norm 10.956580, param norm 191.498016, tps 1511.409157, length mean/std 36.000000/0.000000
INFO:root:epoch 1, iter 5800, cost 2.911489, exp_cost 2.673922, grad norm 4.423927, param norm 193.120605, tps 1510.920111, length mean/std 3.000000/0.000000
INFO:root:epoch 1, iter 6000, cost 2.726106, exp_cost 2.680628, grad norm 27.665518, param norm 194.719833, tps 1511.306345, length mean/std 197.000000/0.000000
INFO:root:epoch 1, iter 6200, cost 2.637073, exp_cost 2.673777, grad norm 9.508832, param norm 196.141312, tps 1511.153480, length mean/std 26.000000/0.000000
I tensorflow/core/common_runtime/bfc_allocator.cc:639] Bin (256): 	Total Chunks: 2, Chunks in use: 0 512B allocated for chunks. 64.0KiB client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:639] Bin (512): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:639] Bin (1024): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:639] Bin (2048): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:639] Bin (4096): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:639] Bin (8192): 	Total Chunks: 2, Chunks in use: 0 22.5KiB allocated for chunks. 68.0KiB client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:639] Bin (16384): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:639] Bin (32768): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:639] Bin (65536): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:639] Bin (131072): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:639] Bin (262144): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:639] Bin (524288): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:639] Bin (1048576): 	Total Chunks: 1, Chunks in use: 0 1.19MiB allocated for chunks. 37.5KiB client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:639] Bin (2097152): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:639] Bin (4194304): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:639] Bin (8388608): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:639] Bin (16777216): 	Total Chunks: 1, Chunks in use: 0 21.74MiB allocated for chunks. 1.88MiB client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:639] Bin (33554432): 	Total Chunks: 2, Chunks in use: 0 121.75MiB allocated for chunks. 63.88MiB client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:639] Bin (67108864): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:639] Bin (134217728): 	Total Chunks: 1, Chunks in use: 0 207.06MiB allocated for chunks. 1.88MiB client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:639] Bin (268435456): 	Total Chunks: 5, Chunks in use: 0 1.89GiB allocated for chunks. 5.69MiB client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:656] Bin for 562.50MiB was 256.00MiB, Chunk State: 
I tensorflow/core/common_runtime/bfc_allocator.cc:662]   Size: 319.19MiB | Requested Size: 1.88MiB | in_use: 0, prev:   Size: 4.00MiB | Requested Size: 4.00MiB | in_use: 1, next:   Size: 871.71MiB | Requested Size: 562.50MiB | in_use: 1
I tensorflow/core/common_runtime/bfc_allocator.cc:662]   Size: 345.62MiB | Requested Size: 64.0KiB | in_use: 0, prev:   Size: 63.8KiB | Requested Size: 60.0KiB | in_use: 1, next:   Size: 2.25MiB | Requested Size: 2.00MiB | in_use: 1
I tensorflow/core/common_runtime/bfc_allocator.cc:662]   Size: 359.88MiB | Requested Size: 4.0KiB | in_use: 0, prev:   Size: 62.00MiB | Requested Size: 62.00MiB | in_use: 1, next:   Size: 58.00MiB | Requested Size: 31.00MiB | in_use: 1
I tensorflow/core/common_runtime/bfc_allocator.cc:662]   Size: 421.25MiB | Requested Size: 1.88MiB | in_use: 0, prev:   Size: 2.38MiB | Requested Size: 2.00MiB | in_use: 1, next:   Size: 4.00MiB | Requested Size: 4.00MiB | in_use: 1
I tensorflow/core/common_runtime/bfc_allocator.cc:662]   Size: 491.00MiB | Requested Size: 1.88MiB | in_use: 0, prev:   Size: 2.25MiB | Requested Size: 2.00MiB | in_use: 1, next:   Size: 4.00MiB | Requested Size: 4.00MiB | in_use: 1
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2304fc0000 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2304fc0100 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2304fc0200 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2304fc0300 of size 4096
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2304fc1300 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2304fc1400 of size 2048
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2304fc1c00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2304fc1d00 of size 4096
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2304fc2d00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2304fc2e00 of size 2048
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2304fc3600 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2304fc3700 of size 4096
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2304fc4700 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2304fc4800 of size 2048
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2304fc5000 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2304fc5100 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2304fc5200 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2304fc5300 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2304fc5400 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2304fc5500 of size 59392
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2304fd3d00 of size 65011712
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2308dd3d00 of size 4096
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2308dd4d00 of size 32505856
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x230acd4d00 of size 2048
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x230acd5500 of size 4194304
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x230b0d5500 of size 2097152
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x230b2d5500 of size 61440
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x230b2e4500 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x230b2e4600 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x230b2e4700 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x230b2e4800 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x230b2e4900 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x230b2e4a00 of size 32565248
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x230d1f3200 of size 32565248
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x230f101a00 of size 4096
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x230f102a00 of size 4194304
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x230f502a00 of size 4194304
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x230fa34400 of size 65536
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311002a00 of size 2048
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311003200 of size 2097152
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311203200 of size 2097152
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311403200 of size 4096
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311404200 of size 61440
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311413200 of size 2048
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311413a00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311413b00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311413c00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311413d00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311413e00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311413f00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311414000 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311414100 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311414200 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311414300 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311414400 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311414500 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311414600 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311414700 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311414800 of size 2048
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311415000 of size 4096
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311416000 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311416100 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311416200 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311416300 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311416400 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311416500 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311416600 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311416700 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311416800 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311416900 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311416a00 of size 3840
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311417900 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311417a00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311417b00 of size 2048
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311418300 of size 4608
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311419500 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311419600 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311419700 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311419800 of size 4096
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x231141a800 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x231141a900 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x231141aa00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x231141ab00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x231141ac00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x231141ae00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x231141b000 of size 2048
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x231141d800 of size 4096
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311422200 of size 61440
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311431200 of size 1912832
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311604200 of size 2048
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311604a00 of size 4194304
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311a04a00 of size 4096
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311a05a00 of size 2097152
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311c05a00 of size 2048
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311c06200 of size 61440
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311c15200 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311c15300 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311c15400 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311c15500 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311c15600 of size 59392
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311c23e00 of size 59392
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2311c32600 of size 65011712
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2315a32600 of size 65011712
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2319832600 of size 4096
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2319833600 of size 4096
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2319834600 of size 32505856
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x231b734600 of size 32505856
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x231d634600 of size 2048
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x231d634e00 of size 2048
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x231d635600 of size 4194304
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x231da35600 of size 4194304
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x231de35600 of size 4096
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x231de36600 of size 4096
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x231de37600 of size 2097152
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x231e037600 of size 2097152
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x231e237600 of size 2048
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x231e237e00 of size 2048
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x231e238600 of size 4194304
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x231e638600 of size 4194304
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x231ea38600 of size 4096
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x231ea39600 of size 4096
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x231ea3a600 of size 2097152
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x231ec3a600 of size 2097152
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x231ee3a600 of size 2048
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x231ee3ae00 of size 2048
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x231ee3b600 of size 61440
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x231ee4a600 of size 61440
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x231ee59600 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x231ee59700 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x231ee59800 of size 65071104
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2322c68000 of size 65011712
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2326a68000 of size 589824000
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x234dae8000 of size 65011712
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x23680c8000 of size 60817408
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x236f688d00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x236f688e00 of size 65280
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x2385038d00 of size 2359296
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x23a3d78d00 of size 4194304
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x23b1088d00 of size 2490368
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x23cb828d00 of size 4194304
I tensorflow/core/common_runtime/bfc_allocator.cc:674] Chunk at 0x23dfb58d00 of size 914060032
I tensorflow/core/common_runtime/bfc_allocator.cc:683] Free at 0x230f902a00 of size 1251840
I tensorflow/core/common_runtime/bfc_allocator.cc:683] Free at 0x230fa44400 of size 22799872
I tensorflow/core/common_runtime/bfc_allocator.cc:683] Free at 0x231141ad00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:683] Free at 0x231141af00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:683] Free at 0x231141b800 of size 8192
I tensorflow/core/common_runtime/bfc_allocator.cc:683] Free at 0x231141e800 of size 14848
I tensorflow/core/common_runtime/bfc_allocator.cc:683] Free at 0x2349ce8000 of size 65011712
I tensorflow/core/common_runtime/bfc_allocator.cc:683] Free at 0x23518e8000 of size 377356288
I tensorflow/core/common_runtime/bfc_allocator.cc:683] Free at 0x236bac8000 of size 62655744
I tensorflow/core/common_runtime/bfc_allocator.cc:683] Free at 0x236f698d00 of size 362414080
I tensorflow/core/common_runtime/bfc_allocator.cc:683] Free at 0x2385278d00 of size 514850816
I tensorflow/core/common_runtime/bfc_allocator.cc:683] Free at 0x23a4178d00 of size 217120768
I tensorflow/core/common_runtime/bfc_allocator.cc:683] Free at 0x23b12e8d00 of size 441712640
I tensorflow/core/common_runtime/bfc_allocator.cc:683] Free at 0x23cbc28d00 of size 334692352
I tensorflow/core/common_runtime/bfc_allocator.cc:689]      Summary of in-use Chunks by size: 
I tensorflow/core/common_runtime/bfc_allocator.cc:692] 60 Chunks of size 256 totalling 15.0KiB
I tensorflow/core/common_runtime/bfc_allocator.cc:692] 17 Chunks of size 2048 totalling 34.0KiB
I tensorflow/core/common_runtime/bfc_allocator.cc:692] 1 Chunks of size 3840 totalling 3.8KiB
I tensorflow/core/common_runtime/bfc_allocator.cc:692] 16 Chunks of size 4096 totalling 64.0KiB
I tensorflow/core/common_runtime/bfc_allocator.cc:692] 1 Chunks of size 4608 totalling 4.5KiB
I tensorflow/core/common_runtime/bfc_allocator.cc:692] 3 Chunks of size 59392 totalling 174.0KiB
I tensorflow/core/common_runtime/bfc_allocator.cc:692] 6 Chunks of size 61440 totalling 360.0KiB
I tensorflow/core/common_runtime/bfc_allocator.cc:692] 1 Chunks of size 65280 totalling 63.8KiB
I tensorflow/core/common_runtime/bfc_allocator.cc:692] 1 Chunks of size 65536 totalling 64.0KiB
I tensorflow/core/common_runtime/bfc_allocator.cc:692] 1 Chunks of size 1912832 totalling 1.82MiB
I tensorflow/core/common_runtime/bfc_allocator.cc:692] 8 Chunks of size 2097152 totalling 16.00MiB
I tensorflow/core/common_runtime/bfc_allocator.cc:692] 1 Chunks of size 2359296 totalling 2.25MiB
I tensorflow/core/common_runtime/bfc_allocator.cc:692] 1 Chunks of size 2490368 totalling 2.38MiB
I tensorflow/core/common_runtime/bfc_allocator.cc:692] 10 Chunks of size 4194304 totalling 40.00MiB
I tensorflow/core/common_runtime/bfc_allocator.cc:692] 3 Chunks of size 32505856 totalling 93.00MiB
I tensorflow/core/common_runtime/bfc_allocator.cc:692] 2 Chunks of size 32565248 totalling 62.11MiB
I tensorflow/core/common_runtime/bfc_allocator.cc:692] 1 Chunks of size 60817408 totalling 58.00MiB
I tensorflow/core/common_runtime/bfc_allocator.cc:692] 5 Chunks of size 65011712 totalling 310.00MiB
I tensorflow/core/common_runtime/bfc_allocator.cc:692] 1 Chunks of size 65071104 totalling 62.06MiB
I tensorflow/core/common_runtime/bfc_allocator.cc:692] 1 Chunks of size 589824000 totalling 562.50MiB
I tensorflow/core/common_runtime/bfc_allocator.cc:692] 1 Chunks of size 914060032 totalling 871.71MiB
I tensorflow/core/common_runtime/bfc_allocator.cc:696] Sum Total of in-use chunks: 2.03GiB
I tensorflow/core/common_runtime/bfc_allocator.cc:698] Stats: 
Limit:                  4583653376
InUse:                  2183763712
MaxInUse:               3872939008
NumAllocs:                56747836
MaxAllocSize:           1007059968

W tensorflow/core/common_runtime/bfc_allocator.cc:270] *****************************_______*x*_______*___________*___**________*_______*************xxxxxxx
W tensorflow/core/common_runtime/bfc_allocator.cc:271] Ran out of memory trying to allocate 562.50MiB.  See logs for memory state.
W tensorflow/core/framework/op_kernel.cc:940] Resource exhausted: OOM when allocating tensor with shape[300,32,15360]
Traceback (most recent call last):
  File "train.py", line 213, in <module>
    tf.app.run()
  File "/home/dong.r/anaconda2/lib/python2.7/site-packages/tensorflow/python/platform/app.py", line 30, in run
    sys.exit(main(sys.argv))
  File "train.py", line 210, in main
    train()
  File "train.py", line 142, in train
    grad_norm, cost, param_norm = model.train(sess, source_tokens, source_mask, target_tokens, FLAGS.keep_prob)
  File "/home/dong.r/BCI/model_concat.py", line 515, in train
    outputs = session.run(output_feed, input_feed)
  File "/home/dong.r/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.py", line 710, in run
    run_metadata_ptr)
  File "/home/dong.r/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.py", line 908, in _run
    feed_dict_string, options, run_metadata)
  File "/home/dong.r/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.py", line 958, in _do_run
    target_list, options, run_metadata)
  File "/home/dong.r/anaconda2/lib/python2.7/site-packages/tensorflow/python/client/session.py", line 978, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors.ResourceExhaustedError: OOM when allocating tensor with shape[300,32,15360]
	 [[Node: gradients/Model/Encoder/dropout/mul_grad/mul = Mul[T=DT_FLOAT, _device="/job:localhost/replica:0/task:0/gpu:0"](gradients/Model/Encoder/RNN/TensorArrayUnpack_grad/TensorArrayPack, Model/Encoder/dropout/Floor)]]
	 [[Node: Adam/update/_22 = _Recv[client_terminated=false, recv_device="/job:localhost/replica:0/task:0/cpu:0", send_device="/job:localhost/replica:0/task:0/gpu:0", send_device_incarnation=1, tensor_name="edge_1551_Adam/update", tensor_type=DT_FLOAT, _device="/job:localhost/replica:0/task:0/cpu:0"]()]]
Caused by op u'gradients/Model/Encoder/dropout/mul_grad/mul', defined at:
  File "train.py", line 213, in <module>
    tf.app.run()
  File "/home/dong.r/anaconda2/lib/python2.7/site-packages/tensorflow/python/platform/app.py", line 30, in run
    sys.exit(main(sys.argv))
  File "train.py", line 210, in main
    train()
  File "train.py", line 95, in train
    model, epoch = create_model(sess, vocab_size, False)
  File "train.py", line 46, in create_model
    flag_bidirect=FLAGS.flag_bidirect, model_sum=FLAGS.flag_sum)
  File "/home/dong.r/BCI/model_concat.py", line 290, in build_model
    self.setup_train()
  File "/home/dong.r/BCI/model_concat.py", line 82, in setup_train
    gradients = tf.gradients(self.losses, params)
  File "/home/dong.r/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/gradients.py", line 476, in gradients
    in_grads = _AsList(grad_fn(op, *out_grads))
  File "/home/dong.r/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/math_grad.py", line 527, in _MulGrad
    return (array_ops.reshape(math_ops.reduce_sum(grad * y, rx), sx),
  File "/home/dong.r/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/math_ops.py", line 760, in binary_op_wrapper
    return func(x, y, name=name)
  File "/home/dong.r/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/math_ops.py", line 909, in _mul_dispatch
    return gen_math_ops.mul(x, y, name=name)
  File "/home/dong.r/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/gen_math_ops.py", line 1464, in mul
    result = _op_def_lib.apply_op("Mul", x=x, y=y, name=name)
  File "/home/dong.r/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.py", line 703, in apply_op
    op_def=op_def)
  File "/home/dong.r/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/ops.py", line 2317, in create_op
    original_op=self._default_original_op, op_def=op_def)
  File "/home/dong.r/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/ops.py", line 1239, in __init__
    self._traceback = _extract_stack()

...which was originally created as op u'Model/Encoder/dropout/mul', defined at:
  File "train.py", line 213, in <module>
    tf.app.run()
[elided 3 identical lines from previous traceback]
  File "train.py", line 46, in create_model
    flag_bidirect=FLAGS.flag_bidirect, model_sum=FLAGS.flag_sum)
  File "/home/dong.r/BCI/model_concat.py", line 274, in build_model
    self.setup_encoder(flag_bidirect=False)
  File "/home/dong.r/BCI/model_concat.py", line 134, in setup_encoder
    inp = tf.nn.dropout(self.encoder_inputs, self.keep_prob)
  File "/home/dong.r/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/nn_ops.py", line 1128, in dropout
    ret = math_ops.div(x, keep_prob) * binary_tensor
  File "/home/dong.r/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/math_ops.py", line 760, in binary_op_wrapper
    return func(x, y, name=name)
  File "/home/dong.r/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/math_ops.py", line 909, in _mul_dispatch
    return gen_math_ops.mul(x, y, name=name)
  File "/home/dong.r/anaconda2/lib/python2.7/site-packages/tensorflow/python/ops/gen_math_ops.py", line 1464, in mul
    result = _op_def_lib.apply_op("Mul", x=x, y=y, name=name)
  File "/home/dong.r/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.py", line 703, in apply_op
    op_def=op_def)
  File "/home/dong.r/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/ops.py", line 2317, in create_op
    original_op=self._default_original_op, op_def=op_def)
  File "/home/dong.r/anaconda2/lib/python2.7/site-packages/tensorflow/python/framework/ops.py", line 1239, in __init__
    self._traceback = _extract_stack()

